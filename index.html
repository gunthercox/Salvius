<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interface</title>
    <link rel="stylesheet" href="css/normalize.css" />
    <link rel="stylesheet" href="css/foundation.css" />
    <link rel="stylesheet" href="css/font-awesome.css"></link>
    <link rel="stylesheet" href="css/salvius.css"></link>
</head>

<body>
    
    <div class="columns">&nbsp;</div>
    
    <div data-alert id="shutdown" class="alert-box shutdown hide">
        <h2 style="color:#f00"><i class="icon-warning-sign"></i> Emergency Shutdown</h2>
        <section>
        <a href="#" class="pushbutton on" id="button"><i class="icon-off"></i></a>
        <span class="led"></span>
        </section>
        <p style="color:#F60">WARNING: This operation will deactivate all systems on the robot.</p>
    </div>

    <div class="large-3 columns">
        <div class="row collapse">
            <div class="small-9 columns">
                <input type="text" placeholder="Text to Speech"/>
            </div>
            <div class="small-3 columns">
                <button class="button prefix"><i class="icon-bullhorn"></i> Say</button>
            </div>
        </div>
        <div class="row collapse">
            <div class="small-9 columns">
                <input type="text" placeholder="Text to Handwriting"/>
            </div>
            <div class="small-3 columns">
                <button class="button prefix"><i class="icon-pencil"></i> Write</button>
            </div>
        </div>
        
        <div class="row collapse">
            <form><fieldset>
                <legend>Configuration</legend>

                <label>Camera IP
                <div class="row collapse">
                    <div class="small-2 columns">
                        <span class="prefix">http://</span>
                    </div>
                    <div class="small-8 columns">
                        <input type="text" class="camera_ip" placeholder="0.0.0.0">
                    </div>
                    <div class="small-2 columns">
                        <a href="#" class="postfix button ok"><i class="icon-ok-sign"></i></a>
                    </div>
                </div>
                </label>
                <label>Arduino IP
                <div class="row collapse">
                    <div class="small-2 columns">
                        <span class="prefix">http://</span>
                    </div>
                    <div class="small-8 columns">
                        <input type="text" class="arduino_ip" placeholder="0.0.0.0">
                    </div>
                    <div class="small-2 columns">
                        <a href="#" class="postfix button ok"><i class="icon-ok-sign"></i></a>
                    </div>
                </div>
                </label>
            </fieldset></form>
        </div>
        
    </div>

    <div class="large-6 columns">
        <div class="row collapse">
            <nav class="top-bar" data-topbar>
                <section class="top-bar-section">
                    <ul class="left">
                        <li class="has-dropdown">
                            <a href="#"><i class="icon-wrench"></i></a>
                            <ul class="dropdown">
                                <li><a href="#configuration"><i class="icon-wrench"></i> Configuration</a></li>
                                <li><a href="http://www.routerlogin.net"><i class="icon-external-link"></i> Router Login</a></li>
                            </ul>
                        </li>
                    </ul>
                    <ul class="right">
                        <li class="has-dropdown">
                            <a href="#" class="warnings"><i class="icon-warning-sign"></i></a>
                            <ul class="dropdown">
                                <li id="camError" class="hide">
                                    <a href="#">Camera input is unavailable.</a>
                                </li>
                                <li class="divider"></li>
                                <li id="apiError" class="hide">
                                    <a href="#">Arduino api is unavailable.</a>
                                </li>
                            </ul>
                        </li>
                        <li class="has-dropdown">
                            <a href="#"><i class="icon-cog"></i></a>
                            <ul class="dropdown">
                                <li><a href="#shutdown"><i class="icon-off"></i> Shutdown</a></li>
                            </ul>
                        </li>
                    </ul>
                </section>
            </nav>
        </div>
        <div class="row collapse">
            <canvas id="cam" class="small-12"/>
            <div id="txt">0</div>
        </div>
        <div class="row collapse">
            <div class="large-12 columns">
                <button class="button small-2 columns"><i class="icon-rotate-left"></i></button>
                <button class="button small-2 columns"><i class="icon-chevron-sign-left"></i></button>
                
                <button class="button small-2 columns"><i class="icon-chevron-sign-up"></i></button>
                <button class="button small-2 columns"><i class="icon-chevron-sign-down"></i></button>
                
                <button class="button small-2 columns"><i class="icon-chevron-sign-right"></i></button>
                <button class="button small-2 columns"><i class="icon-rotate-right"></i></button>
            </div>
        </div>
    </div>

    <div class="large-3 columns">
        <div class="row collapse">
            <input type="text" class="filter" style="display:none" placeholder="Filter available sensors"/>
            <table style="width:100%">
                <thead>
                    <tr>
                        <th class="center"><i class="icon-compass"></i> Sensor</th>
                        <th class="center">Value</th>
                    </tr>
                </thead>
                <tbody class="sensorValues">
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- for posting to api -->
    <form action='http://192.168.1.177' method='post'><h1>Digital Pins</h1><p>Digital 0: <label><input type='radio' name='d0' value='1' /> On</label> <label><input type='radio' name='d0' value='0' checked /> Off</label><br/>Digital 1: <label><input type='radio' name='d1' value='1' /> On</label> <label><input type='radio' name='d1' value='0' checked /> Off</label><br/>Digital 2: <label><input type='radio' name='d2' value='1' checked /> On</label> <label><input type='radio' name='d2' value='0' /> Off</label><br/>Digital 3: <label><input type='radio' name='d3' value='1' checked /> On</label> <label><input type='radio' name='d3' value='0' /> Off</label><br/>Digital 4: <label><input type='radio' name='d4' value='1' /> On</label> <label><input type='radio' name='d4' value='0' checked /> Off</label><br/>Digital 5: <label><input type='radio' name='d5' value='1' /> On</label> <label><input type='radio' name='d5' value='0' checked /> Off</label><br/>Digital 6: <label><input type='radio' name='d6' value='1' /> On</label> <label><input type='radio' name='d6' value='0' checked /> Off</label><br/>Digital 7: <label><input type='radio' name='d7' value='1' /> On</label> <label><input type='radio' name='d7' value='0' checked /> Off</label><br/>Digital 8: <label><input type='radio' name='d8' value='1' /> On</label> <label><input type='radio' name='d8' value='0' checked /> Off</label><br/>Digital 9: <label><input type='radio' name='d9' value='1' /> On</label> <label><input type='radio' name='d9' value='0' checked /> Off</label><br/></p><h1>Analog Pins</h1><p>Analog 0: 485<br/>Analog 1: 363<br/>Analog 2: 291<br/>Analog 3: 254<br/>Analog 4: 222<br/>Analog 5: 226<br/></p><input type='submit' value='Submit'/></form>

<script src="js/jquery.js"></script>
<script src="js/foundation/foundation.js"></script>
<script src="js/foundation/foundation.topbar.js"></script>
<script type="text/javascript">

$(document).foundation();

// SETTINGS
var camera_ip = "192.168.1.2";
var arduino_ip = "192.168.1.177";

$(".camera_ip").val(camera_ip);
$(".arduino_ip").val(arduino_ip);

var cameraImage = ["http://", camera_ip, "/image.jpg"].join("");
var arduinoJson = ["http://", arduino_ip].join("");

var iUpdateMs = 100;
var count = 0;
var newImg;

function error() {
    $(".warnings").css("color", "#f08a24");
};

$.get(cameraImage, function(data) {
    setTimeout("imageupdate()", iUpdateMs );
}).error(function() {
    error();
    $("#camError").show();
});

function imageupdate() {
	document.getElementById("txt").innerHTML = count++;

	newImg = new Image();
	newImg.Id = "camimg" + count;
	newImg.Name = newImg.Id;
	newImg.onload = imageLoaded;
	newImg.src = cameraImage + "?u=" + count;
}

function imageLoaded() {
	var drawingCanvas = document.getElementById("cam");

	// Check if the browser supports canvas
	if(drawingCanvas.getContext) {
		var context = drawingCanvas.getContext("2d");
		context.drawImage(newImg,0,0,640,480,0,0,300,150);
	}

	setTimeout("imageupdate()", iUpdateMs);
}

$('a[href="#shutdown"]').click(function() {
    $("#shutdown").show();
});

$.ajax({ 
    type: 'GET', 
    url: arduinoJson, 
    data: { get_param: 'value' }, 
    dataType: 'json',
    success: function (data) {
        $.each(data, function(index, element) {
            $('.sensorValues').append('<tr><td>' + index + '</td><td>' + element + '</td></tr>');
        });
        $(".filter").show();
    }
}).error(function() {
    error();
    $("#apiError").show();
});
</script>
</body>
</html>
